<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profesyonel Ara√ß Takip</title>
    <style>
        :root {
            --primary: #2563eb;
            --success: #16a34a;
            --danger: #dc2626;
            --dark: #1e293b;
            --light: #f8fafc;
        }

        body {
            font-family: 'Inter', system-ui, sans-serif;
            background-color: #e2e8f0;
            margin: 0;
            display: flex;
            justify-content: center;
            padding: 20px;
        }

        .app-card {
            background: white;
            width: 100%;
            max-width: 500px;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            padding: 25px;
            overflow: hidden;
        }

        .header { text-align: center; margin-bottom: 25px; }
        .header h1 { margin: 0; color: var(--dark); font-size: 1.5rem; }
        .header p { color: #64748b; margin: 5px 0 0; }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-box {
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            color: white;
        }

        .stat-box.in { background-color: var(--success); }
        .stat-box.out { background-color: var(--danger); }
        .stat-box span { font-size: 2.5rem; font-weight: 800; display: block; }
        .stat-box label { font-size: 0.8rem; text-transform: uppercase; opacity: 0.9; }

        .inside-count {
            background: var(--light);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 25px;
            border: 2px dashed #cbd5e1;
        }

        .controls { display: grid; gap: 10px; }
        
        .btn {
            border: none;
            padding: 18px;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            font-size: 1rem;
            transition: transform 0.1s, opacity 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn:active { transform: scale(0.97); }
        .btn-in { background: var(--success); color: white; }
        .btn-out { background: var(--danger); color: white; }
        
        .history-section {
            margin-top: 30px;
            border-top: 1px solid #e2e8f0;
            padding-top: 20px;
        }

        .history-list {
            max-height: 200px;
            overflow-y: auto;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .log-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .action-btns {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn-small {
            flex: 1;
            padding: 10px;
            font-size: 0.75rem;
            background: #64748b;
            color: white;
            border-radius: 8px;
        }

        .btn-reset { background: #94a3b8; }
    </style>
</head>
<body>

<div class="app-card">
    <div class="header">
        <h1>Ara√ß Sayƒ±m Sistemi</h1>
        <p id="current-date"></p>
    </div>

    <div class="stats-grid">
        <div class="stat-box in">
            <span id="total-in">0</span>
            <label>Toplam Giri≈ü</label>
        </div>
        <div class="stat-box out">
            <span id="total-out">0</span>
            <label>Toplam √áƒ±kƒ±≈ü</label>
        </div>
    </div>

    <div class="inside-count">
        ≈ûu An ƒ∞√ßeride Olan: <strong id="current-inside" style="font-size: 1.2rem; color: var(--primary);">0</strong>
    </div>

    <div class="controls">
        <button class="btn btn-in" onclick="updateCount('in')">üöó Gƒ∞Rƒ∞≈û YAP (+1)</button>
        <button class="btn btn-out" onclick="updateCount('out')">üì§ √áIKI≈û YAP (-1)</button>
    </div>

    <div class="history-section">
        <strong>Son ƒ∞≈ülemler</strong>
        <div id="history-list" class="history-list">
            </div>
    </div>

    <div class="action-btns">
        <button class="btn btn-small" onclick="exportData()">üìä Excel/CSV ƒ∞ndir</button>
        <button class="btn btn-small btn-reset" onclick="resetApp()">üóëÔ∏è Verileri Sƒ±fƒ±rla</button>
    </div>
</div>

<script>
    // Ba≈ülangƒ±√ß verilerini LocalStorage'dan al veya bo≈ü obje olu≈ütur
    let data = JSON.parse(localStorage.getItem('carCounterDB')) || {
        inCount: 0,
        outCount: 0,
        logs: []
    };

    function init() {
        document.getElementById('current-date').innerText = new Date().toLocaleDateString('tr-TR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        updateUI();
    }

    function updateCount(type) {
        const now = new Date();
        const timeStr = now.getHours().toString().padStart(2, '0') + ":" + now.getMinutes().toString().padStart(2, '0');
        
        if (type === 'in') {
            data.inCount++;
            data.logs.unshift({ type: 'Giri≈ü', time: timeStr });
        } else {
            data.outCount++;
            data.logs.unshift({ type: '√áƒ±kƒ±≈ü', time: timeStr });
        }

        // Sadece son 50 kaydƒ± tut (hafƒ±zayƒ± ≈üi≈üirmemek i√ßin)
        if (data.logs.length > 50) data.logs.pop();
        
        saveAndRefresh();
    }

    function saveAndRefresh() {
        localStorage.setItem('carCounterDB', JSON.stringify(data));
        updateUI();
    }

    function updateUI() {
        document.getElementById('total-in').innerText = data.inCount;
        document.getElementById('total-out').innerText = data.outCount;
        document.getElementById('current-inside').innerText = Math.max(0, data.inCount - data.outCount);

        const historyHtml = data.logs.map(log => `
            <div class="log-item">
                <span style="color: ${log.type === 'Giri≈ü' ? 'var(--success)' : 'var(--danger)'}">‚óè ${log.type}</span>
                <span style="color: #64748b">${log.time}</span>
            </div>
        `).join('');
        
        document.getElementById('history-list').innerHTML = historyHtml || '<p style="color:#cbd5e1; text-align:center">Hen√ºz i≈ülem yok</p>';
    }

    function exportData() {
        let csvContent = "data:text/csv;charset=utf-8,Tip,Zaman\n";
        data.logs.forEach(log => {
            csvContent += `${log.type},${log.time}\n`;
        });
        const encodedUri = encodeURI(csvContent);
        const link = document.createElement("a");
        link.setAttribute("href", encodedUri);
        link.setAttribute("download", "arac_sayim_raporu.csv");
        document.body.appendChild(link);
        link.click();
    }

    function resetApp() {
        if (confirm("T√ºm veriler kalƒ±cƒ± olarak silinecek. Emin misiniz?")) {
            data = { inCount: 0, outCount: 0, logs: [] };
            saveAndRefresh();
        }
    }

    init();
</script>

</body>
</html>
