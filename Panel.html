<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>iSTAY MASTER - Finansal Yönetim</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        .tab-active { border-bottom: 3px solid #e11d48; color: #e11d48; }
        .status-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 5px; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body class="bg-slate-900 text-white pb-24">
    <div class="max-w-md mx-auto px-4">
        <header class="flex justify-between items-center py-6 border-b border-slate-800 mb-6">
            <div>
                <h1 class="text-xl font-black text-rose-500 italic uppercase">iSTAY MASTER</h1>
                <div id="connStatus" class="text-[9px] font-bold text-slate-500 mt-1 uppercase tracking-widest flex items-center">
                    <span id="connDot" class="status-dot bg-rose-500 animate-pulse"></span>
                    <span id="connText">BAĞLANTI BEKLENİYOR</span>
                </div>
            </div>
            <div class="flex gap-2">
                <button onclick="verileriCek()" class="w-10 h-10 rounded-xl bg-slate-800 flex items-center justify-center text-emerald-500 active:rotate-180 transition-all"><i class="fas fa-sync-alt"></i></button>
                <button onclick="ayarlariAc()" class="w-10 h-10 rounded-xl bg-slate-800 flex items-center justify-center text-slate-400"><i class="fas fa-cog"></i></button>
            </div>
        </header>

        <nav class="flex justify-around mb-6 border-b border-slate-800 text-[10px] font-bold text-slate-500 uppercase tracking-widest">
            <button onclick="tabDegistir('takip')" id="tab-takip" class="pb-3 tab-active">Takip & Rapor</button>
            <button onclick="tabDegistir('sube')" id="tab-sube" class="pb-3">Şubeler</button>
            <button onclick="tabDegistir('personel')" id="tab-personel" class="pb-3">Personel</button>
        </nav>

        <section id="section-sube" class="hidden space-y-4">
            <div class="bg-slate-800 p-6 rounded-[2rem] border border-slate-700 shadow-xl">
                <input type="text" id="parkName" placeholder="Şube Adı (Örn: Beşiktaş Okulu)" class="w-full bg-slate-900 p-4 rounded-xl mb-4 text-sm border border-slate-700 text-white outline-none focus:border-rose-500">
                
                <div class="mb-6">
                    <h4 class="text-[10px] font-black text-rose-500 mb-2 uppercase italic border-l-2 border-rose-500 pl-2">Otomobil Tarifesi (0-24 Saat)</h4>
                    <div class="grid grid-cols-4 gap-2 text-[10px]">
                        <div>0-1S<input type="number" id="f1" value="100" class="w-full bg-slate-900 p-2 mt-1 rounded-lg border border-slate-700 text-white"></div>
                        <div>1-2S<input type="number" id="f2" value="150" class="w-full bg-slate-900 p-2 mt-1 rounded-lg border border-slate-700 text-white"></div>
                        <div>2-4S<input type="number" id="f4" value="200" class="w-full bg-slate-900 p-2 mt-1 rounded-lg border border-slate-700 text-white"></div>
                        <div>4-6S<input type="number" id="f6" value="250" class="w-full bg-slate-900 p-2 mt-1 rounded-lg border border-slate-700 text-white"></div>
                        <div>6-8S<input type="number" id="f8" value="300" class="w-full bg-slate-900 p-2 mt-1 rounded-lg border border-slate-700 text-white"></div>
                        <div>8-12S<input type="number" id="f12" value="350" class="w-full bg-slate-900 p-2 mt-1 rounded-lg border border-slate-700 text-white"></div>
                        <div class="col-span-2">12-24S<input type="number" id="f24" value="450" class="w-full bg-slate-900 p-2 mt-1 rounded-lg border border-slate-700 text-white"></div>
                    </div>
                </div>

                <div class="mb-6">
                    <h4 class="text-[10px] font-black text-blue-500 mb-2 uppercase italic border-l-2 border-blue-500 pl-2">Minibüs Tarifesi (0-24 Saat)</h4>
                    <div class="grid grid-cols-4 gap-2 text-[10px]">
                        <div>0-1S<input type="number" id="m1" value="150" class="w-full bg-slate-900 p-2 mt-1 rounded-lg border border-slate-700 text-white"></div>
                        <div>1-2S<input type="number" id="m2" value="200" class="w-full bg-slate-900 p-2 mt-1 rounded-lg border border-slate-700 text-white"></div>
                        <div>2-4S<input type="number" id="m4" value="250" class="w-full bg-slate-900 p-2 mt-1 rounded-lg border border-slate-700 text-white"></div>
                        <div>4-6S<input type="number" id="m6" value="300" class="w-full bg-slate-900 p-2 mt-1 rounded-lg border border-slate-700 text-white"></div>
                        <div>6-8S<input type="number" id="m8" value="350" class="w-full bg-slate-900 p-2 mt-1 rounded-lg border border-slate-700 text-white"></div>
                        <div>8-12S<input type="number" id="m12" value="400" class="w-full bg-slate-900 p-2 mt-1 rounded-lg border border-slate-700 text-white"></div>
                        <div class="col-span-2">12-24S<input type="number" id="m24" value="550" class="w-full bg-slate-900 p-2 mt-1 rounded-lg border border-slate-700 text-white"></div>
                    </div>
                </div>

                <p class="text-[8px] text-slate-500 mb-4 italic text-center">* İlk 4 dakika tüm şubelerde otomatik olarak ücretsizdir.</p>
                <button onclick="otoparkEkle()" class="w-full bg-emerald-600 p-4 rounded-xl font-black text-xs uppercase shadow-lg active:scale-95 transition">ŞUBEYİ TÜM FİYATLARLA KAYDET</button>
            </div>
            <div id="subeListesi" class="space-y-2"></div>
        </section>

        </div>

    <script>
        // ... bağlantı ve senkronizasyon kodları ...

        function otoparkEkle() {
            const name = document.getElementById('parkName').value.trim();
            
            // Otomobil Baremi
            const otoPrices = [
                parseInt(document.getElementById('f1').value), parseInt(document.getElementById('f2').value),
                parseInt(document.getElementById('f4').value), parseInt(document.getElementById('f6').value),
                parseInt(document.getElementById('f8').value), parseInt(document.getElementById('f12').value),
                parseInt(document.getElementById('f24').value)
            ];

            // Minibüs Baremi
            const miniPrices = [
                parseInt(document.getElementById('m1').value), parseInt(document.getElementById('m2').value),
                parseInt(document.getElementById('m4').value), parseInt(document.getElementById('m6').value),
                parseInt(document.getElementById('m8').value), parseInt(document.getElementById('m12').value),
                parseInt(document.getElementById('m24').value)
            ];

            if(!name) return alert("Lütfen şube adı girin.");

            db.otoparklar.push({
                id: Date.now(),
                name: name,
                prices: otoPrices,
                minibusPrices: miniPrices,
                ucretsizSure: 4 // Sabit 4 dakika kuralı
            });
            verileriKaydet();
            document.getElementById('parkName').value = "";
        }

        // ... tabDegistir ve renderAll fonksiyonları ...
    </script>
</body>
</html>
